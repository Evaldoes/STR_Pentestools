from scapy.all import*
probe_response = {} #dic

def probeResponse(pacote):
    if pacote.haslayer(Dot11ProbeResp): #verifica se o pacote Ã© do tipo Probe Request
        if pacote.info:
            if pacote.addr1 not in probe_response.keys():
                probe_response[pacote.addr1] = set([pacote.info])
                print "BSSID ->", pacote.addr2 
                print "MAC do cliente ->", pacote.addr1
                print "ESSID ->", pacote.info # nome da rede
                print
            elif pacote.info not in probe_response[pacote.addr1]:
                probe_response[pacote.addr1].add(pacote.info)
                print "BSSID ->", pacote.addr2
                print "MAC do cliente ->", pacote.addr1
                print "ESSID ->", pacote.info # nome da rede
                print
sniff(iface = "mon0", prn = probeResponse)