from scapy.all import*
probe_request = {}

def probeRequest(pacote):
    if pacote.haslayer(Dot11ProbeReq):
        if pacote.info:
            if pacote.addr2 not in probe_request.keys():
                probe_request[pacote.addr2] = set([pacote.info])
                print "MAC do cliente ->", pacote.addr2
                print "ESSID ->", pacote.info
                print
            elif pacote.info not in probe_request[pacote.addr2]:
                probe_request[pacote.addr2].add(pacote.info)
                print "MAC do cliente ->", pacote.addr2
                print "ESSID ->", pacote.info
                print
sniff(iface = "mon0", prn = probeRequest)